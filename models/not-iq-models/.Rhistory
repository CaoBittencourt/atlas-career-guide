matrix(-1, nrow = 2, ncol = 2)
dbl_starting_values <- c(0,0)
fun_objective <- function(x){
1 -
((x[1] - 0.5) ^ 2) / 2 -
((x[2] - 0.83) ^ 2) / 2 -> u
return(-u)
}
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
, A = matrix(-1, nrow = 2, ncol = 2)
, B = rbind(0.5,0.5)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
fun_objective <- function(x){
1 -
((x[1] - 0.5) ^ 2) / 2 -
((x[2] - 0.83) ^ 2) / 2 -> u
return(-u)
}
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
, A = matrix(-1, nrow = 2, ncol = 2)
, B = rbind(1,0.5)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
fun_objective <- function(x){
1 -
((x[1] - 0.5) ^ 2) / 2 -
((x[2] - 0.83) ^ 2) / 2 -> u
return(-u)
}
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
, A = matrix(-1, nrow = 2, ncol = 2)
, B = rbind(1,1)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
, A = matrix(-1, nrow = 2, ncol = 2)
, B = rbind(0,0)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
rbind(c(-1,-1),c(1,1))
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, A = rbind(c(-1,-1),c(1,1))
, B = rbind(1,0.5)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, A = rbind(c(-1,-1),c(1,1))
, B = rbind(1,1)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, A = rbind(c(-1,-1),c(1,1))
, B = rbind(0.5,1)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, A = rbind(c(-1,-1),c(1,1))
, B = rbind(0.5,0.5)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, A = rbind(c(-1,-1),c(1,1))
, B = rbind(0.5,0.25)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, A = rbind(c(-1,-1),c(1,1))
, B = rbind(1,0.25)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, Aeq = rbind(c(-1,-1),c(1,1))
, Beq = rbind(1,0.25)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, Aeq = rbind(c(-1,-1),c(1,1))
, Beq = rbind(1,0.25)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
round(solnl(
X = dbl_starting_values
, objfun = fun_objective
# , A = matrix(-1, nrow = 2, ncol = 2)
, A = rbind(c(-1,-1),c(1,1))
, B = rbind(1,0.25)
, lb = rep(0, length(dbl_starting_values))
, ub = rep(1, length(dbl_starting_values))
)$par, 2)
exp(1/12*(1.12 - 1.05))
(7000/3)/exp(1/12*(1.12 - 1.05))
(7000/3)/exp(1/12*(1.12 - 1.05)^(1/12))
(7000/3)/exp((1.12 - 1.05)^(1/12))
(7000/3)/exp((1.05 - 1.12)^(1/12))
(7000/3)/exp((1.12^(1/12) - 1.05^(1/12)))
(7000/3)/exp((-1.12^(1/12) + 1.05^(1/12)))
7000 / 3
w <- 7000 / 3
r <- 1.12
inflation <- 1.05
w / r
r/inflation
inflation <- 1.04
r/inflation
(r/inflation) ^ 1 / 12
(r/inflation) ^ (1 / 12)
((r/inflation) ^ (1 / 12) - 1)
w / ((r/inflation) ^ (1 / 12) - 1)
exp(r - inflation)
exp((1 / 12)*(r - inflation)
)
exp((1 / 12)*(r - inflation))
exp((1 / 12)*(r - inflation)) - 1
(exp((1 / 12)*(r - inflation)) - 1)
w / (exp((1 / 12)*(r - inflation)) - 1)
w / ((r/inflation) ^ (1 / 12) - 1)
w / (exp((1 / 12)*(r - inflation)) - 1)
1.12 ^ 1/12
1.12 ^ (1/12)
w <- 7000 / 3
rm <- 1.12 ^ (1/12)
inflationm <- 1.04 ^ (1/12)
((rm/inflationm) - 1)
w / ((rm/inflationm) - 1)
w / (exp((rm - inflationm)) - 1)
w / (exp((1 / 12)*(r - inflation)) - 1)
w / (exp((rm - inflationm)) - 1)
w / ((rm/inflationm) - 1)
w <- 7000 / 3
r <- 1.12
inflation <- 1.04
w / ((r/inflation) ^ (1 / 12) - 1)
w / (exp((1 / 12)*(r - inflation)) - 1)
w / (exp((1 / 12)*((r - inflation)^(1/12))) - 1)
w / (exp((1 / 12)*(r^(1/12) - inflation^(1/12))) - 1)
w / (exp((rm - inflationm)) - 1)
w / ((rm/inflationm) - 1)
# - Workspace -------------------------------------------------------------
setwd(dirname(
rstudioapi::getSourceEditorContext()$path
))
tryCatch(
load('./sketch_not_iq_image.RData')
, error = function(e){
source('./sketch_not_iq_setup.R')
}
)
# - Packages --------------------------------------------------------------
lapply(
c(chr_profile, pkg)
, function(x){
if(!require(
x, character.only = T
)){
install.packages(x)
require(x)
}}
)
select <- dplyr::select
# - Data ------------------------------------------------------------------
# User data
read_csv(
# 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSVdXvQMe4DrKS0LKhY0CZRlVuCCkEMHVJHQb_U-GKF21CjcchJ5jjclGSlQGYa5Q/pub?gid=47461225&single=true&output=csv'
'https://docs.google.com/spreadsheets/d/e/2PACX-1vSVdXvQMe4DrKS0LKhY0CZRlVuCCkEMHVJHQb_U-GKF21CjcchJ5jjclGSlQGYa5Q/pub?gid=1515296378&single=true&output=csv'
) -> df_input
# # Maids
# df_occupations %>%
#   select(
#     occupation
#     , ends_with('.l')
#   ) %>%
#   filter(
#     occupation ==
#       'Maids and Housekeeping Cleaners'
#   ) -> df_input
# df_occupations %>%
#   slice_sample(
#     n = 1
#   ) %>%
#   select(
#     occupation
#     , ends_with('.l')
#   ) -> df_input
#
# df_input$occupation
# - Parameters ------------------------------------------------------------
# Mean IQ
dbl_iq_mean <- 100
# IQ Standard Deviation
dbl_iq_sd <- 15
# IQ Proxy
df_factors$
factor.name %>%
unique()
df_factors %>%
filter(str_detect(
str_to_lower(
factor.name
), 'intellig|discern'
# ), 'intellig|discern|analytical|humanities'
# ), 'intellig|discern|analytical'
# ), 'intellig'
)) %>%
pull(item) ->
chr_iq_proxy
df_occupations %>%
select(
employment2
, any_of(
chr_iq_proxy
)
) %>%
pivot_longer(
cols = -1
, names_to = 'item'
, values_to = 'item.score'
) %>%
reframe(
iq_proxy_mean =
weighted.mean(
item.score
, employment2
)
, iq_proxy_sd =
wtd.var(
item.score
, employment2
)
, iq_proxy_sd =
sqrt(iq_proxy_sd)
) -> df_iq_proxy
# WAIS IQ Labels
seq(
dbl_iq_mean - 3 * 10
, dbl_iq_mean + 3 * 10
, 10
) -> dbl_iq_seq
c(
'Retarded',
'Borderline Retarded',
'Low Average',
'Average',
'High Average',
'Bright',
'Very Bright'
) -> chr_iq_wais
chr_iq_wais ->
names(dbl_iq_seq)
# - Estimate Occupation's NOT IQ -----------------------------------------------------
df_occupations %>%
select(
occupation
, employment2
, annual_wage_2021
, any_of(
chr_iq_proxy
)) %>%
pivot_longer(
cols = any_of(chr_iq_proxy)
, names_to = 'item'
, values_to = 'item.score'
) %>%
group_by(occupation) %>%
reframe(
NOT_IQ =
fun_not_iq(
dbl_scores = item.score
, dbl_proxy_mean =
df_iq_proxy$
iq_proxy_mean
, dbl_proxy_sd =
df_iq_proxy$
iq_proxy_sd
, dbl_iq_mean =
dbl_iq_mean
, dbl_iq_sd =
dbl_iq_sd
)
, employment2 =
first(employment2)
, annual_wage_2021 =
first(annual_wage_2021)
) %>%
mutate(
NOT_IQ_class =
findInterval(
NOT_IQ
, dbl_iq_seq
),
NOT_IQ_class =
recode(
NOT_IQ_class
, '0' = chr_iq_wais[[1]]
, '1' = chr_iq_wais[[1]]
, '2' = chr_iq_wais[[2]]
, '3' = chr_iq_wais[[3]]
, '4' = chr_iq_wais[[4]]
, '5' = chr_iq_wais[[5]]
, '6' = chr_iq_wais[[6]]
, '7' = chr_iq_wais[[7]]
),
NOT_IQ_class =
factor(
NOT_IQ_class
, levels =
chr_iq_wais
)
) -> df_occupations_not_iq
df_occupations_not_iq
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'physician|hospital|patholo|medic'
))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'physician|hospital|patholo|medic'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'NURSE'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'nurse'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso|sociolo'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso|sociolo|writers'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso|sociolo|writers|math'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso|sociolo|writers|math|physicist'
)) %>% arrange(desc(NOT_IQ))
df_occupations_not_iq$occupation
df_occupations_not_iq %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso|sociolo|writers|math|physicist|bio'
)) %>% arrange(desc(NOT_IQ))
121 - 117
(117/121)-1
128/133 - 1
134/128 - 1
130/107 - 1
df_occupations %>%
select(
occupation
, employment2
, annual_wage_2021
, any_of(
chr_iq_proxy
)) %>%
pivot_longer(
cols = any_of(chr_iq_proxy)
, names_to = 'item'
, values_to = 'item.score'
)
df_occupations %>%
select(
occupation
, employment2
, annual_wage_2021
, any_of(
chr_iq_proxy
)) %>%
pivot_longer(
cols = any_of(chr_iq_proxy)
, names_to = 'item'
, values_to = 'item.score'
) %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso'
))
df_occupations %>%
select(
occupation
, employment2
, annual_wage_2021
, any_of(
chr_iq_proxy
)) %>%
pivot_longer(
cols = any_of(chr_iq_proxy)
, names_to = 'item'
, values_to = 'item.score'
) %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso'
)) %>%
arrange(desc(
item.score
))
df_occupations %>%
select(
occupation
, employment2
, annual_wage_2021
, any_of(
chr_iq_proxy
)) %>%
pivot_longer(
cols = any_of(chr_iq_proxy)
, names_to = 'item'
, values_to = 'item.score'
) %>%
filter(str_detect(
str_to_lower(occupation)
, 'philoso'
)) %>%
arrange(desc(
item.score
)) %>% view
# - Packages ----------------------------------------------------------------
pkg <- c(
'tidyverse' #Data wrangling
, 'openxlsx' #Export excel
)
# Activate / install packages
lapply(pkg, function(x)
if(!require(x, character.only = T))
{install.packages(x); require(x)})
# Package citation
# lapply(pkg, function(x)
#   {citation(package = x)})
# - Data --------------------------------------------------------------------
# Occupations data frame
read_csv(
'C:/Users/Cao/Documents/Github/Atlas-Research/Data/df_occupations_2023.csv'
) -> df_occupations
view(df_occupations)
view(df_occupations)
# - Data --------------------------------------------------------------------
# Occupations data frame
read_csv(
'C:/Users/Cao/Documents/Github/Atlas-Research/Data/df_occupations_2023.csv'
, skip = 5
) -> df_occupations
view(df_occupations)
# - Data --------------------------------------------------------------------
# Occupations data frame
read_csv(
'C:/Users/Cao/Documents/Github/Atlas-Research/Data/df_occupations_2023.csv'
, skip = 3
) -> df_occupations
