max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_extract(
factor
, '[::digit::]'
)
)
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_extract(
factor
, '[0-9]'
)
)
fun_factor_loadings
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_extract(
factor
, '[[::digit::]]+'
)
) %>%
print(n = nrow(.))
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_extract(
factor
, '[[::digit::]]+'
)
)
fun_factor_loadings
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_remove_all(
factor
, 'factor'
)
)
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_remove_all(
factor
, 'factor'
)
) %>%
arrange(desc(factor)) %>%
print(n = nrow(.))
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_remove_all(
factor
, 'factor'
)
) %>%
arrange(factor) %>%
print(n = nrow(.))
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
mutate(
factor =
str_remove_all(
factor
, 'factor'
)
, factor =
as.numeric(factor)
) %>%
arrange(factor) %>%
print(n = nrow(.))
fun_efa.nfactors(as_tibble(lalala))
dsdsds
fun_efa.nfactors(as_tibble(dsdsds))
psych::fa(
r = dsdsds
, nfactors = 10
, rotate = 'oblimin'
) -> lalala
lalala
fun_factor_loadings(lalala) %>%
pivot_longer(
cols = -1
, names_to = 'factor'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() -> lala
lala %>%
mutate(
factor =
str_remove_all(
factor
, 'factor'
)
, factor =
as.numeric(factor)
) %>%
arrange(factor) %>%
print(n = nrow(.))
# - PCA on factor scores ---------------------------------------------
# Items -> Factors (individual cognitive electrical signals)
# Factors -> Factor scores (cognitive electrical patterns)
# Factor scores -> Factors PCA (cognitive functions)
# Factors PCA -> K-means Clusters (personality types)
# Se -> Si -> Ne -> Ni
fun_factor_scores(
df_data = df_occupations
, efa_model = efa_model
, lgc_pivot = T
)
# - PCA on factor scores ---------------------------------------------
# Items -> Factors (individual cognitive electrical signals)
# Factors -> Factor scores (cognitive electrical patterns)
# Factor scores -> Factors PCA (cognitive functions)
# Factors PCA -> K-means Clusters (personality types)
# Se -> Si -> Ne -> Ni
fun_factor_scores(
df_data = df_occupations
, efa_model = efa_model
)
# - PCA on factor scores ---------------------------------------------
# Items -> Factors (individual cognitive electrical signals)
# Factors -> Factor scores (cognitive electrical patterns)
# Factor scores -> Factors PCA (cognitive functions)
# Factors PCA -> K-means Clusters (personality types)
# Se -> Si -> Ne -> Ni
fun_factor_scores(
df_data = df_occupations
, efa_model = efa_model
) -> dsdsds
dsdsds %>%
select(starts_with('factor'))
dsdsds %>%
select(
starts_with(
'factor')
) %>%
fun_efa.nfactors(
.dbl_weights =
df_occupations$
employment2
)
dsdsds %>%
select(
starts_with(
'factor')
) %>%
pca(nfactors = 4)
dsdsds %>%
select(
starts_with(
'factor')
) %>%
pca(nfactors = 4) ->
lalala
fun_factor_loadings(lalala)
class(lalala)
loadings(lalala)
lalala$values
lalala$rotation
lalala$loadings
lalala$fit
lalala$uniquenesses
lalala$communality
lalala$r.scores
round(lalala$r.scores,4)
lalala$valid
lalala$weights
dsdsds %>%
select(
starts_with(
'factor')
) %>%
pca(
nfactors = 4
, weight =
df_occupations$
employment2
) ->
lalala
lalala$loadings
loadings(lalala)
df_occupations %>%
select(ends_with('.l'))
df_occupations %>%
select(ends_with('.l')) %>%
pca(
nfactors = 15
, weight =
df_occupations$
employment2
) -> lalalala
df_occupations %>%
select(ends_with('.l')) %>%
pca(
nfactors = 15
, rotate =
'equamax'
, weight =
df_occupations$
employment2
) -> lalalala
lalalala
loadings(lalalala)
loadings(lalalala)[,]
loadings(lalalala)[,1]
view(as_tibble(loadings(lalalala)[,]))
view(as_tibble(loadings(lalalala)[,], rownames = 'item'))
loadings('dsds')
class(lalala)
class(efa_model)
# - Factor loadings function ----------------------------------------------
fun_factor_loadings <- function(efa_model){
# Arguments validation
stopifnot(
"'efa_model' must be a factor analysis object." =
any(
str_to_lower(class(
efa_model
)) == 'factanal'
, str_to_lower(class(
efa_model
)) == 'fa'
, str_to_lower(class(
efa_model
)) == 'principal'
)
)
# Get factor loadings
loadings(efa_model)[,] %>%
as_tibble(
rownames = 'item'
) -> df_loadings
# Data wrangling
df_loadings %>%
set_names(
c(
'item'
, df_loadings[-1] %>%
names() %>%
# , loadings(efa_model)[,] %>%
#   colnames() %>%
str_extract(
'[[:digit:]]+'
) %>%
paste0('factor',.)
)
) %>%
relocate(
item
, str_sort(
names(.)
, numeric = T
)
) -> df_loadings
# Output
return(df_loadings)
}
lalalala %>%
fun_factor_loadings()
lalalala %>%
fun_factor_loadings() %>%
view
lalalala %>%
fun_factor_loadings() %>%
pivot_longer(
cols = -1
, names_to = 'component'
, values_to = 'loading'
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup()
lalalala %>%
fun_factor_loadings() %>%
pivot_longer(
cols = -1
, names_to = 'component'
, values_to = 'loading'
) %>%
mutate(
component =
str_replace_all(
component
, 'factor'
, 'component'
)
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup()
lalalala %>%
fun_factor_loadings() %>%
pivot_longer(
cols = -1
, names_to = 'component'
, values_to = 'loading'
) %>%
mutate(
component =
str_replace_all(
component
, 'factor'
, 'component'
)
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
view
lalalala
lalalala %>%
fun_factor_loadings() %>%
pivot_longer(
cols = -1
, names_to = 'component'
, values_to = 'loading'
) %>%
mutate(
component =
str_replace_all(
component
, 'factor'
, 'component'
)
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
view
df_occupations %>%
select(ends_with('.l')) %>%
t() %>%
`colnames<-`(
df_occupations$
occupation
)
df_occupations %>%
select(ends_with('.l')) %>%
t() %>%
`colnames<-`(
df_occupations$
occupation
) %>%
pca(
nfactors = 16
# , rotate =
#   'equamax'
, weight =
df_occupations$
employment2
) -> lalalala
lalalala
lalalala %>%
fun_factor_loadings() %>%
pivot_longer(
cols = -1
, names_to = 'component'
, values_to = 'loading'
) %>%
mutate(
component =
str_replace_all(
component
, 'factor'
, 'component'
)
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
view
df_occupations %>%
select(ends_with('.l')) %>%
t() %>%
`colnames<-`(
df_occupations$
occupation
) %>%
pca(
nfactors = 4
# , rotate =
#   'equamax'
, weight =
df_occupations$
employment2
) -> lalalala
lalalala %>%
fun_factor_loadings() %>%
pivot_longer(
cols = -1
, names_to = 'component'
, values_to = 'loading'
) %>%
mutate(
component =
str_replace_all(
component
, 'factor'
, 'component'
)
) %>%
group_by(item) %>%
filter(
loading ==
max(loading)
) %>%
ungroup() %>%
view
